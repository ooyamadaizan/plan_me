<%= render "shared/header" %>

<h1>タスク一覧</h1>

<%= link_to '新規タスク作成', new_task_path, class: 'btn btn-primary' %>

<div class="tasks-container">
  <% @tasks.each do |task| %>
    <div class="task-item">
      <h3><%= task.title %></h3>
      <p><%= truncate(task.description, length: 50) %></p>
      <p>期限: <%= task.due_date.strftime('%Y年%m月%d日') %></p>
      <p>状態: <%= task.completed ? '完了' : '未完了' %></p>
      <div class="task-actions">
        <%= link_to '詳細', task_path(task), class: 'btn btn-info' %>
        <%= link_to '編集', edit_task_path(task), class: 'btn btn-warning' %>
        <%= button_to '削除', task_path(task), method: :delete, data: { confirm: '本当に削除しますか？' }, class: 'btn btn-danger' %>
      </div>
    </div>
  <% end %>
</div>

<h2>カレンダー</h2>

<%= month_calendar(events: @tasks) do |date, tasks| %>
  <%= date.day %>

  <% tasks.each do |task| %>
    <div class="calendar-task">
      <%= link_to task.title, task_path(task) %>
    </div>
  <% end %>
<% end %>

<div id="digital-clock"></div>

<script>
function updateClock() {
  const now = new Date();
  const clock = document.getElementById('digital-clock');
  clock.textContent = now.toLocaleTimeString();
}

setInterval(updateClock, 1000);
updateClock();
</script>
